import{j as a}from"./jsx-runtime.D_zvdyIk.js";import{r as o}from"./index.Bgw4UDry.js";/* empty css                       */const w=()=>{const[p,j]=o.useState(null),[h,m]=o.useState([]),[E,l]=o.useState(!1),[d,s]=o.useState({idExperiencia:0,materia:"",calidad:"",universidad:"",concluidoEl:""}),[i,c]=o.useState(null),[N,x]=o.useState(!1),[t,f]=o.useState(!1);o.useEffect(()=>{(async()=>{const n=localStorage.getItem("idDocente");if(!n){alert("No se encontró el ID del docente en localStorage");return}j(Number(n)),l(!0);try{const r=await fetch(`http://localhost:4321/api/docentes/${n}`);if(!r.ok)throw new Error("Error al obtener datos del docente");const u=await r.json();console.log("Datos recibidos de la API:",u),u.experienciasdocentes&&Array.isArray(u.experienciasdocentes)?m(u.experienciasdocentes):(console.error("Formato de datos incorrecto:",u),alert("No se encontraron experiencias docentes o el formato es incorrecto."))}catch(r){console.error("Error al cargar datos:",r)}finally{l(!1)}})()},[]);const v=async()=>{if(p===null){alert("ID del docente no encontrado");return}l(!0);try{const e=await fetch("/api/expdoc/expdocpost",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({idDocente:p,experienciasDocente:[d]})});if(e.ok){const n=await e.json();m(n.experienciasDocente),alert("Nueva experiencia docente agregada con éxito"),s({idExperiencia:0,materia:"",calidad:"",universidad:"",concluidoEl:""}),x(!1)}else{const n=await e.json();console.error("Error del servidor:",n),alert("Hubo un error al agregar la experiencia docente")}}catch(e){console.error("Error en el cliente:",e),alert("Hubo un error al agregar la experiencia docente")}finally{l(!1)}},b=async()=>{if(p===null||i===null){alert("No se puede actualizar la experiencia docente");return}l(!0);try{const e=await fetch("/api/expdoc/expdocput",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({idDocente:p,experienciasDocente:[{idExperienciaDocente:i.idExperiencia,materia:i.materia,calidad:i.calidad,universidad:i.universidad,concluidoEl:i.concluidoEl}]})});if(e.ok){const n=await e.json();m(n.experienciasDocente),alert("Experiencia docente actualizada con éxito"),c(null),x(!1)}else{const n=await e.json();console.error("Error del servidor:",n),alert("Hubo un error al actualizar la experiencia docente")}}catch(e){console.error("Error en el cliente:",e),alert("Hubo un error al actualizar la experiencia docente")}finally{l(!1)}},g=e=>{e?(c(e),f(!0)):(f(!1),s({idExperiencia:0,materia:"",calidad:"",universidad:"",concluidoEl:""})),x(!0)},D=()=>{x(!1),c(null)};return a.jsxs("div",{className:"experiencia-docente-container",children:[a.jsx("h1",{className:"experiencia-docente-title",children:"Gestión de Experiencia Docente"}),E&&a.jsx("p",{className:"experiencia-docente-loading",children:"Cargando..."}),a.jsx("h2",{className:"experiencia-docente-subtitle",children:"Experiencias actuales"}),h.filter(e=>e!==null).length>0?a.jsx("ul",{className:"experiencia-docente-list",children:h.filter(e=>e!==null).map((e,n)=>a.jsxs("li",{className:"experiencia-docente-item",children:[a.jsx("strong",{children:"Materia:"})," ",e.materia,", ",a.jsx("strong",{children:"Calidad:"})," ",e.calidad,","," ",a.jsx("strong",{children:"Universidad:"})," ",e.universidad,", ",a.jsx("strong",{children:"Concluido el:"})," ",new Date(e.concluidoEl).toLocaleDateString()," ",a.jsx("button",{className:"experiencia-docente-button editar-button",onClick:()=>g(e),children:"Editar"})]},e.idExperiencia))}):a.jsx("p",{className:"experiencia-docente-empty",children:"No hay experiencias docentes registradas."}),a.jsx("button",{className:"experiencia-docente-button agregar-button",onClick:()=>g(),children:"Agregar nueva experiencia"}),N&&a.jsx("div",{className:"modal",children:a.jsxs("div",{className:"modal-content",children:[a.jsx("h2",{className:"modal-title",children:t?"Editar experiencia docente":"Agregar nueva experiencia docente"}),a.jsxs("form",{className:"experiencia-docente-form",onSubmit:e=>{e.preventDefault(),t?b():v()},children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"form-label",children:"Materia:"}),a.jsx("input",{className:"form-input",type:"text",value:t?i?.materia:d.materia,onChange:e=>{const n=e.target.value;t?c(r=>r&&{...r,materia:n}):s(r=>({...r,materia:n}))},required:!0})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"form-label",children:"Calidad:"}),a.jsx("input",{className:"form-input",type:"text",value:t?i?.calidad:d.calidad,onChange:e=>{const n=e.target.value;t?c(r=>r&&{...r,calidad:n}):s(r=>({...r,calidad:n}))},required:!0})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"form-label",children:"Universidad:"}),a.jsx("input",{className:"form-input",type:"text",value:t?i?.universidad:d.universidad,onChange:e=>{const n=e.target.value;t?c(r=>r&&{...r,universidad:n}):s(r=>({...r,universidad:n}))},required:!0})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"form-label",children:"Fecha de conclusión:"}),a.jsx("input",{className:"form-input",type:"date",value:t?i?.concluidoEl:d.concluidoEl,onChange:e=>{const n=e.target.value;t?c(r=>r&&{...r,concluidoEl:n}):s(r=>({...r,concluidoEl:n}))},required:!0})]}),a.jsx("button",{className:"experiencia-docente-button guardar-button",type:"submit",children:t?"Actualizar":"Guardar"}),a.jsx("button",{className:"experiencia-docente-button cancelar-button",type:"button",onClick:D,children:"Cancelar"})]})]})})]})};export{w as default};
