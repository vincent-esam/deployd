import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as l}from"./index.Bgw4UDry.js";/* empty css                       */import{C as T}from"./CountrySelect.DJ9TbNX7.js";import{G as N,M as y}from"./GradosSelect.BZhHRorV.js";function C({selectedTypes:u,onTypesChange:h,valueAndId:p}){const[m,j]=l.useState([]);return l.useEffect(()=>{(async()=>{try{const r=await fetch("/api/tipoe/tipoe");if(r.ok){const t=await r.json(),i=t.filter(c=>c.idTipoEstudio===1),o=t.filter(c=>c.idTipoEstudio===2);j([...i,...o])}else console.error("Error al obtener los Tipos de estudios")}catch(r){console.error("Error al consumir la API:",r)}})()},[]),e.jsxs("label",{children:["Tipo de estudio:",e.jsxs("select",{name:p,id:p,value:u.id||"",onChange:a=>{const r=parseInt(a.target.value,10),t=m.find(i=>i.idTipoEstudio===r);t&&h({id:t.idTipoEstudio,name:t.tipo})},children:[e.jsx("option",{value:"",disabled:!0,children:"Selecciona un tipo de estudio"}),m.map(a=>e.jsx("option",{value:a.idTipoEstudio,children:a.tipo},a.idTipoEstudio))]})]})}const I=()=>{const[u,h]=l.useState(null),[p,m]=l.useState(!0),[j,a]=l.useState(""),[r,t]=l.useState(!1),[i,o]=l.useState(null);if(l.useEffect(()=>{(async()=>{const d=localStorage.getItem("idDocente");if(!d){console.error("No se encontró el idDocente en el localStorage.");return}try{const n=await fetch(`http://localhost:4321/api/docentes/${d}`);if(!n.ok)throw new Error("Error al obtener datos del docente");const f=await n.json();h(f)}catch(n){console.error("Error al cargar datos:",n)}finally{m(!1)}})()},[]),p)return e.jsx("p",{children:"Cargando datos..."});if(!u)return e.jsx("p",{children:"Error: No se pudieron cargar los datos del docente."});const{idDocente:c,estudiossuperiores:x}=u,E=(s,d)=>{i&&o({...i,[d]:s.target.value})},g=async()=>{if(i)try{if(i.idEstudio===null){const s=await fetch("/api/estudiossuppost",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({idDocente:c,estudiossuperiores:[{universidad:i.universidad,carrera:i.carrera,fecha:i.fecha,nombre:i.nombre,idPais:Number(i.idPais),idGrado:Number(i.idGrado),idModalidad:Number(i.idModalidad),idTipoEstudio:Number(i.idTipoEstudios)}]})});if(!s.ok)throw new Error("Error al crear el estudio");const d=await s.json();a(d.message||"Estudio creado correctamente"),h(n=>n?{...n,estudiossuperiores:n.estudiossuperiores.map(f=>f===i?{...i,idEstudio:d.idEstudio}:f)}:null)}else{const s=await fetch("/api/estudiossup",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({idDocente:c,idEstudioSuperior:i.idEstudio,updateFields:{universidad:i.universidad,carrera:i.carrera,fecha:i.fecha,nombre:i.nombre,idPais:i.idPais,idGrado:i.idGrado,idModalidad:i.idModalidad,idTipoEstudio:i.idTipoEstudios}})});if(!s.ok)throw new Error("Error al actualizar el estudio");const d=await s.json();a(d.message||"Estudio actualizado correctamente")}}catch(s){console.error("Error:",s),a("Error al guardar el estudio")}finally{o(null)}},v=()=>{o({idEstudio:null,universidad:"",carrera:"",fecha:"",nombre:"",idPais:0,pais:"",idGrado:0,gradoTipo:"",idModalidad:0,modalidad:"",idTipoEstudios:0,tipoEstudios:""})},b=()=>{t(s=>!s)};return e.jsxs("div",{className:"postdegreeform-container",children:[e.jsx("h3",{className:"form-title",children:"Información del Docente"}),x.length>3&&e.jsx("button",{className:"toggle-button1",onClick:b,children:r?"Mostrar menos":"Mostrar más"}),e.jsx("button",{className:"create-button1",onClick:v,children:"Crear Nuevo Estudio"}),e.jsxs("p",{hidden:!0,children:["ID Docente: ",c]}),x.filter(s=>s!==null).length===0?e.jsx("p",{children:"No hay estudios para mostrar. Por favor, crea uno nuevo."}):x.filter(s=>s!==null).slice(0,r?x.length:2).map((s,d)=>e.jsxs("div",{className:"study-card",children:[e.jsxs("h4",{className:`study-title ${s.idEstudio?"hidden":""}`,children:["Estudio Superior #",s.idEstudio||"Nuevo"]}),e.jsxs("div",{className:"study-fields",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Universidad:"})," ",s.universidad]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Carrera:"})," ",s.carrera]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Fecha:"})," ",s.fecha]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Nombre:"})," ",s.nombre]}),e.jsxs("p",{children:[e.jsx("strong",{children:"País:"})," ",s.pais]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Grado:"})," ",s.gradoTipo]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Modalidad:"})," ",s.modalidad]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Tipo de Estudios:"})," ",s.tipoEstudios]})]}),e.jsx("button",{className:"edit-button2",onClick:()=>o(s),children:"Editar"})]},d)),j&&e.jsx("p",{className:"message-text",children:j}),i&&e.jsx("div",{className:"modal",children:e.jsxs("div",{className:"modal-content",children:[e.jsx("div",{className:"modal-title",children:e.jsx("h4",{children:"Editar Estudio"})}),e.jsxs("div",{children:[e.jsx("label",{children:"Universidad:"}),e.jsx("input",{className:"custom-input",type:"text",value:i.universidad,onChange:s=>E(s,"universidad")})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Carrera:"}),e.jsx("input",{className:"custom-input",type:"text",value:i.carrera,onChange:s=>E(s,"carrera")})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Fecha:"}),e.jsx("input",{className:"custom-input",type:"date",value:i.fecha,onChange:s=>E(s,"fecha")})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Nombre:"}),e.jsx("input",{className:"custom-input",type:"text",value:i.nombre,onChange:s=>E(s,"nombre")})]}),e.jsx("div",{children:e.jsx(T,{valueAndId:"idPais",selectedId:i.idPais,selected:i.pais,selectedCountry:{id:i.idPais,name:i.pais},onCountryChange:s=>{o(d=>d?{...d,idPais:s.id,pais:s.name}:null)}})}),e.jsx("div",{children:e.jsx(N,{valueAndId:"idGrado",selectedId:i.idGrado,selected:i.gradoTipo,selectedGrado:{id:i.idGrado,name:i.gradoTipo},onGradoChange:s=>{o(d=>d?{...d,idGrado:s.id,gradoTipo:s.name}:null)}})}),e.jsx("div",{children:e.jsx(y,{valueAndId:"idModalidad",selectedId:i.idModalidad,selected:i.modalidad,selectedModalidad:{id:i.idModalidad,name:i.modalidad},onModalidadChange:s=>{o(d=>d?{...d,idModalidad:s.id,modalidad:s.name}:null)}})}),e.jsx("div",{children:e.jsx(C,{valueAndId:"idTipoEstudio",selectedTypes:{id:i.idTipoEstudios,name:i.tipoEstudios},onTypesChange:s=>{o(d=>d?{...d,idTipoEstudios:s.id,tipoEstudios:s.name}:null)}})}),e.jsx("button",{className:"save-button",onClick:g,children:"Guardar"}),e.jsx("button",{className:"cancel-button",onClick:()=>o(null),children:"Cancelar"})]})})]})};export{I as default};
