import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as i}from"./index.Bgw4UDry.js";import{M as C}from"./modale.CSXVFH5r.js";import{o as T}from"./jwt-decode.esm.DvUShIk5.js";const k=({tipoArchivo:a})=>{const[c,h]=i.useState([]),[p,n]=i.useState(""),[u,r]=i.useState(null),[x,b]=i.useState(null),[D,g]=i.useState([]),[f,v]=i.useState(null);i.useEffect(()=>{const t=localStorage.getItem("token");if(t)try{const o=T(t);r(o.idDocente),b(o.nombre)}catch(o){console.error("Error al decodificar el token:",o)}else console.error("Token no encontrado. Por favor, inicia sesión.")},[]),i.useEffect(()=>{(async()=>{try{const o=await fetch("/api/dashboard/get_tipos_archivos"),d=await o.json();if(o.ok){g(d);const l=d.find(s=>s.tipo.toLowerCase()===a.toLowerCase());l?v(l.id_ta):n(`No se encontró un tipo de archivo llamado '${a}'.`)}else console.error("Error al obtener tipos de archivo:",d.error)}catch(o){console.error("Error al llamar a la API:",o)}})()},[a]);const y=t=>{const o=Array.from(t.target.files);m(o)},j=t=>{t.preventDefault();const o=Array.from(t.dataTransfer.files);m(o)},m=t=>{const d=t.filter(s=>s.size<=2097152);t.filter(s=>s.size>2097152).length>0&&n("Algunos archivos superan el tamaño máximo de 2 MB y no se agregarán."),h(s=>[...s,...d])},S=async()=>{if(!c.length){n("Por favor, selecciona uno o más archivos válidos.");return}if(!u||!x){n("No se pudo obtener la información del docente.");return}if(!f){n("No se ha seleccionado un tipo de archivo válido.");return}let t=0,o=0;for(const d of c){const l=new FormData;l.append("docente_id",u),l.append("docente_name",x),l.append("archivo",d),l.append("idtipo_archivo",f);try{(await fetch("/api/insert_archivos",{method:"POST",body:l})).ok?t++:o++}catch(s){console.error("Error al subir archivo:",s),o++}}n(`${t} archivo(s) subido(s) con éxito. ${o} archivo(s) no pudieron ser subidos.`),h([])};return e.jsxs("div",{style:{textAlign:"center",padding:"20px",border:"1px solid #ccc",borderRadius:"8px"},children:[e.jsxs("h3",{children:["Subir ",a]}),e.jsxs("div",{onDragOver:t=>t.preventDefault(),onDrop:j,style:{border:"2px dashed #ccc",padding:"100px",marginBottom:"20px",borderRadius:"8px",background:"#f9f9f9",cursor:"pointer"},children:[c.length>0?e.jsx("ul",{children:c.map((t,o)=>e.jsx("li",{children:t.name},o))}):e.jsx("p",{children:"Arrastra tus archivos aquí o haz clic para seleccionarlos"}),e.jsx("input",{type:"file",onChange:y,multiple:!0,style:{display:"none"},id:"file-input"}),e.jsx("label",{htmlFor:"file-input",style:{color:"#007BFF",cursor:"pointer",fontSize:"21px"},children:"Seleccionar archivos"})]}),e.jsxs("button",{onClick:S,disabled:!c.length,children:["Subir ",a]}),p&&e.jsx("p",{style:{color:p.includes("Error")?"red":"green"},children:p})]})},M=()=>{const[a,c]=i.useState(!1),[h,p]=i.useState(""),n=x=>{p(x),c(!0)},u=()=>{c(!1),p("")},r={container:{marginTop:"20px",width:"95%",marginLeft:"10px",padding:"20px",backgroundColor:"#fff",borderRadius:"8px",boxShadow:"0 4px 8px rgba(0, 0, 0, 0.1)",maxHeight:"600px",overflowY:"auto"},title:{fontSize:"28px",fontWeight:"bold",color:"#002f6c",textAlign:"center",marginBottom:"20px"},sectionTitle:{fontSize:"23px",fontWeight:"bold",color:"#444",marginBottom:"10px"},paragraph:{margin:"5px 0",color:"#555",fontWeight:"bold"},button:{padding:"10px 20px",backgroundColor:"#007bff",color:"#fff",border:"none",borderRadius:"5px",cursor:"pointer",marginBottom:"10px"}};return e.jsxs("div",{style:r.container,children:[e.jsx("h1",{style:r.title,children:"Archivos Docente"}),e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("h2",{style:r.sectionTitle,children:"Información Personal"}),e.jsx("p",{style:r.paragraph,children:"Carnet:"}),e.jsx("button",{style:r.button,onClick:()=>n("carnet"),children:"Subir Carnet"}),e.jsx("p",{style:r.paragraph,children:"Titulo en provisión nacional:"}),e.jsx("button",{style:r.button,onClick:()=>n("tituloProvisionN"),children:"Subir Titulo Provisión Nacional"})]}),e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("h2",{style:r.sectionTitle,children:"Certificados"}),e.jsx("button",{style:r.button,onClick:()=>n("certificados"),children:"Subir Certificado"})]}),e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("h2",{style:r.sectionTitle,children:"Diplomados"}),e.jsx("button",{style:r.button,onClick:()=>n("diplomados"),children:"Subir Diplomado"})]}),e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("h2",{style:r.sectionTitle,children:"Maestrías"}),e.jsx("button",{style:r.button,onClick:()=>n("maestrias"),children:"Subir Maestría"})]}),e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("h2",{style:r.sectionTitle,children:"Doctorados"}),e.jsx("button",{style:r.button,onClick:()=>n("doctorados"),children:"Subir Doctorado"})]}),a&&e.jsx(C,{isOpen:a,onClose:u,title:`Subir ${h}`,children:e.jsx(k,{tipoArchivo:h})})]})};export{M as ProfileUpload};
