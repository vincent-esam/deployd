import{j as a}from"./jsx-runtime.CLpGMVip.js";import{r}from"./index.CXuOLBzL.js";/* empty css                       */function A({selectedIdioma:j,onIdiomaChange:u,valueAndId:s,selected:l,selectedId:d}){const[h,m]=r.useState([]);return r.useEffect(()=>{(async()=>{try{const c=await fetch("/api/idiomas/idiomas");if(c.ok){const n=await c.json();m(n)}else console.error("Error al obtener los grados")}catch(c){console.error("Error al consumir la API:",c)}})()},[]),a.jsxs("label",{children:["Idiomas:",a.jsxs("select",{name:s,id:s,value:j?.id||"",onChange:i=>{const c=parseInt(i.target.value,10),n=h.find(I=>I.idIdioma===c);n&&u({id:n.idIdioma,name:n.idioma})},children:[a.jsx("option",{value:d,selected:!0,children:l}),h.map(i=>a.jsx("option",{value:i.idIdioma,children:i.idioma},i.idIdioma))]})]})}const T=()=>{const[j,u]=r.useState(null),[s,l]=r.useState({idIdioma:"",idioma:"",escritura:1,oral:1,lectura:1,escucha:1}),[d,h]=r.useState(null),[m,i]=r.useState(null),[c,n]=r.useState(!1),[I,x]=r.useState(!1),[N,g]=r.useState(!1);r.useEffect(()=>{(async()=>{const o=localStorage.getItem("idDocente");if(!o){alert("No se encontró el ID del docente en localStorage");return}i(o),n(!0);try{const t=await fetch(`http://localhost:4321/api/docentes/${o}`);if(!t.ok)throw new Error("Error al obtener datos del docente");const D=await t.json();u(D)}catch(t){console.error("Error al cargar datos:",t)}finally{n(!1)}})()},[]);const E=e=>{const{name:o,value:t}=e.target;l({...s,[o]:parseInt(t)})},f=e=>{if(d){const{name:o,value:t}=e.target;h({...d,[o]:parseInt(t)})}},w=()=>{l({idioma:"",idIdioma:"",escritura:1,oral:1,lectura:1,escucha:1}),x(!0)},b=()=>{x(!1)},y=e=>{h(e),g(!0)},v=()=>{g(!1)},C=async()=>{if(!m){alert("No se encontró el ID del docente");return}try{const e=await fetch("/api/idiomasdoc/idiomasdocpost",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({idDocente:m,idiomas:[s]})});if(!e.ok)throw new Error("Error al crear el idioma");alert("Idioma creado con éxito"),l({idioma:"",idIdioma:"",escritura:1,oral:1,lectura:1,escucha:1});const o=await e.json();u(o),b()}catch(e){console.error("Error al agregar idioma:",e)}},S=async()=>{if(!m||!d){alert("No se encontró el ID del docente o el idioma seleccionado");return}try{const e=await fetch("/api/idiomasdoc/idiomasdocput",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({idDocente:m,idiomas:[d]})});if(!e.ok)throw new Error("Error al actualizar el idioma");alert("Idioma actualizado con éxito");const o=await e.json();u(o),v()}catch(e){console.error("Error al actualizar idioma:",e)}},p=e=>{switch(Number(e)){case 3:return"Alto";case 2:return"Medio";case 1:return"Bajo";default:return"No especificado"}};return c?a.jsx("p",{children:"Cargando datos..."}):a.jsxs("div",{className:"idiomas-manager",children:[a.jsx("h1",{children:"Gestión de Idiomas"}),a.jsx("button",{onClick:w,className:"button add-button",children:"Agregar Idioma"}),a.jsx("div",{className:"idiomas-list",children:j?.idiomas.filter(e=>e!==null).map(e=>a.jsxs("div",{className:"idioma-card",children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Idioma:"})," ",e.idioma]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Escritura:"})," ",p(e.escritura)]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Oral:"})," ",p(e.oral)]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Lectura:"})," ",p(e.lectura)]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Escucha:"})," ",p(e.escucha)]}),a.jsx("button",{onClick:()=>y(e),className:"button edit-button",children:"Editar"})]},e.idIdiomaDocente||e.idIdioma))}),I&&a.jsx("div",{className:"modalidioma-add-overlay",children:a.jsxs("div",{className:"modalidioma-add",children:[a.jsx("h2",{children:"Agregar Nuevo Idioma"}),a.jsx(A,{selectedIdioma:{id:parseInt(s.idIdioma||"0"),name:s.idioma},onIdiomaChange:e=>l({...s,idIdioma:e.id.toString(),idioma:e.name}),valueAndId:"idIdioma",selected:s.idioma,selectedId:parseInt(s.idIdioma||"0")}),["escritura","oral","lectura","escucha"].map(e=>a.jsxs("div",{className:"modalidioma-add-checkbox-group",children:[a.jsx("label",{children:e.charAt(0).toUpperCase()+e.slice(1)}),["Alto","Medio","Bajo"].map((o,t)=>a.jsxs("div",{children:[a.jsx("input",{type:"radio",name:e,value:3-t,checked:s[e]===3-t,onChange:E}),a.jsx("label",{children:o})]},t))]},e)),a.jsx("button",{className:"modalidioma-add-button",onClick:C,children:"Agregar"}),a.jsx("button",{className:"modalidioma-add-button-close",onClick:b,children:"Cerrar"})]})}),N&&d&&a.jsx("div",{className:"modalidioma-overlay",children:a.jsxs("div",{className:"modalidioma",children:[a.jsx("h2",{children:"Editar Idioma"}),a.jsx("input",{type:"text",name:"idIdioma",placeholder:"ID Idioma",value:d.idIdioma,onChange:f,disabled:!0}),["escritura","oral","lectura","escucha"].map(e=>a.jsxs("div",{className:"modalidioma-checkbox-group",children:[a.jsx("label",{children:e.charAt(0).toUpperCase()+e.slice(1)}),["Alto","Medio","Bajo"].map((o,t)=>a.jsxs("div",{children:[a.jsx("input",{type:"radio",name:e,value:3-t,checked:d[e]===3-t,onChange:f}),a.jsx("label",{children:o})]},t))]},e)),a.jsx("button",{className:"modalidioma-button",onClick:S,children:"Actualizar"}),a.jsx("button",{className:"modalidioma-button-close",onClick:v,children:"Cerrar"})]})})]})};export{T as default};
