import{j as a}from"./jsx-runtime.CLpGMVip.js";import{r as o}from"./index.CXuOLBzL.js";/* empty css                        */import{C as b}from"./CountrySelect.Bs7slKRn.js";const T=()=>{const[s,f]=o.useState(null),[h,p]=o.useState([]),[m,x]=o.useState(!1),[i,l]=o.useState({nombre:"",enlaceEditorial:"",idTipoPublicacion:0,idPais:0,pais:"",fecha:""}),[t,c]=o.useState(null),[g,j]=o.useState(!1),[C,P]=o.useState(!1);o.useEffect(()=>{(async()=>{const n=localStorage.getItem("idDocente");if(!n){alert("No se encontró el ID del docente en localStorage");return}f(Number(n)),x(!0);try{const r=await fetch(`http://localhost:4321/api/docentes/${n}`);if(!r.ok)throw new Error("Error al obtener datos del docente");const u=await r.json();p(u.publicacionesintelectuales||[])}catch(r){console.error("Error al cargar datos:",r)}finally{x(!1)}})()},[]);const v=e=>{c(e),j(!0)},d=()=>{j(!1),P(!1),c(null)},E=async()=>{if(!s||!t)return;const e=JSON.stringify({idDocente:s,produccionesIntelectuales:[t]});try{if(!(await fetch("/api/prodintelectual/prodintelput",{method:"PUT",headers:{"Content-Type":"application/json"},body:e})).ok)throw new Error("Error al actualizar producción intelectual");alert("Producción intelectual actualizada correctamente"),p(r=>r.map(u=>u.idProduccionIntelectual===t.idProduccionIntelectual?t:u)),d()}catch(n){console.error("Error en la actualización:",n)}},y=async()=>{if(!s)return;const e=JSON.stringify({idDocente:s,produccionesIntelectuales:[i]});try{const n=await fetch("/api/prodintelectual/prodintelpost",{method:"POST",headers:{"Content-Type":"application/json"},body:e});if(!n.ok)throw new Error("Error al crear nueva producción intelectual");const r=await n.json();alert("Nueva producción intelectual creada"),p([...h,r.publicacionesintelectuales[0]]),d()}catch(n){console.error("Error en la creación:",n)}};return a.jsxs("div",{className:"producciones-manager",children:[a.jsx("h2",{children:"Gestión de Producciones Intelectuales"}),m&&a.jsx("p",{children:"Cargando datos..."}),!m&&a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"create-button",onClick:()=>P(!0),children:"Crear Nueva Producción"}),a.jsx("div",{className:"producciones-list",children:h.map(e=>a.jsxs("div",{className:"produccion-item",children:[a.jsx("h4",{children:e.nombre}),a.jsxs("p",{children:["Enlace Editorial:"," ",a.jsx("a",{href:e.enlaceEditorial,target:"_blank",rel:"noopener noreferrer",children:e.enlaceEditorial})]}),a.jsxs("p",{children:["Tipo de Publicación: ",e.idTipoPublicacion]}),a.jsxs("p",{children:["País: ",e.pais]}),a.jsxs("p",{children:["Fecha: ",e.fecha]}),a.jsx("button",{onClick:()=>v(e),children:"Editar"})]},e.idProduccionIntelectual))})]}),g&&t&&a.jsx("div",{className:"modal edit-modal",children:a.jsxs("div",{className:"modal-content",children:[a.jsx("h3",{children:"Editar Producción Intelectual"}),a.jsx("input",{type:"text",placeholder:"Nombre",value:t.nombre,onChange:e=>c({...t,nombre:e.target.value})}),a.jsx("input",{type:"text",placeholder:"Enlace Editorial",value:t.enlaceEditorial,onChange:e=>c({...t,enlaceEditorial:e.target.value})}),a.jsx("input",{type:"number",placeholder:"Tipo de Publicación",value:t.idTipoPublicacion,onChange:e=>c({...t,idTipoPublicacion:parseInt(e.target.value)})}),a.jsx("div",{children:a.jsx(b,{valueAndId:"idPais",selectedId:t.idPais,selected:t?.pais,selectedCountry:{id:t?.idPais||0,name:t?.pais||""},onCountryChange:e=>{c(n=>n?{...n,idPais:e.id,pais:e.name}:null)}})}),a.jsx("input",{type:"date",value:t.fecha,onChange:e=>c({...t,fecha:e.target.value})}),a.jsx("button",{onClick:E,children:"Guardar Cambios"}),a.jsx("button",{onClick:d,children:"Cerrar"})]})}),C&&a.jsx("div",{className:"modal create-modal",children:a.jsxs("div",{className:"modal-content",children:[a.jsx("h3",{children:"Crear Nueva Producción Intelectual"}),a.jsx("input",{type:"text",placeholder:"Nombre",value:i.nombre,onChange:e=>l({...i,nombre:e.target.value})}),a.jsx("input",{type:"text",placeholder:"Enlace Editorial",value:i.enlaceEditorial,onChange:e=>l({...i,enlaceEditorial:e.target.value})}),a.jsx("input",{type:"number",placeholder:"Tipo de Publicación",value:i.idTipoPublicacion,onChange:e=>l({...i,idTipoPublicacion:parseInt(e.target.value)})}),a.jsx("div",{children:a.jsx(b,{valueAndId:"idPais",selectedId:i.idPais,selected:i.pais||"",selectedCountry:{id:i.idPais||0,name:i.pais||""},onCountryChange:e=>{l(n=>({...n,idPais:e.id,pais:e.name}))}})}),a.jsx("input",{type:"date",value:i.fecha,onChange:e=>l({...i,fecha:e.target.value})}),a.jsx("button",{onClick:y,children:"Crear"}),a.jsx("button",{onClick:d,children:"Cerrar"})]})})]})};export{T as default};
